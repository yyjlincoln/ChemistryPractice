<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>
    <div
        style="display: flex; flex-direction: column; justify-content: center; position: relative; width: 100%; height: 100%;">
        <div
            style="display: flex; flex-direction: row; justify-content: center; padding-left: 10%; padding-right: 10%;">
            <div style="display: flex; flex-direction: column; justify-content: center; text-align: center;">
                <div>
                    Chemistry Practice
                </div>
                <div id="question">
                    Fetching...
                </div>
                <form id="eqinput" onSubmit="return osubmit(eqinput.equation.value);"
                    style="padding-top: 10px; padding-bottom: 10px; margin: 0px;">
                    <input id="equation" name="equation" type="text"
                        style="padding-top: 0px; padding-bottom: 0px; margin: 0px; width: 60%; height: 25px; min-width: 320px; margin-top: 10px; margin-bottom: 10px;" />
                    <button type="submit"
                        style="border: 0px; height: 25px; margin-top: 10px; margin-bottom: 10px;">Check</button>
                </form>
            </div>
        </div>

        <div style="position: relative; width: 100%; text-align: center;">
            <div id="notification"
                style="display: flex; flex-direction: row; padding-left: 10px; padding-right: 10px; text-align: center; width: 100%;">
            </div>
        </div>
    </div>

    </div>
</body>

<script src="./jquery-3.4.1.min.js"></script>
<script>
    var serverURL = 'https://apis.chem.teamerdev.xyz/' // https://apis.chem.teamerdev.xyz/
    var word = ''
    function reset(){
        setTimeout(()=>{
            $("#equation").val('')
            $("#question").text("Fetching...")
            $("#notification").text("")
            fetch()
        },1500)
    }
    function fetch(){
        $.get(serverURL+'next',{
        }, (data)=>{
            console.log(data.word,data.code)
            word=data.word
            if(data.code!=0){
                $("#notification").text("error:"+data.msg)
            } else {
                console.log('0')
                $("#question").text(data.word)
                word = data.word
                $("#equation").focus()
            }
        })
    }
    function osubmit(url) {
        console.log(url)
        $.post(serverURL+'check', {
            'word':word,
            'equation': url
        }, (data) => {
            if (data.code == 0) {
                if(data.correct){
                    $('#notification').text('You are correct!')
                    reset()
                } else {
                    $('#notification').text('Incorrect, '+data.word+': Symbol '+data.symbol+', Charge '+data.charge)
                    reset()
                }
            } else {
                $('#notification').text('error:'+data.msg)
                reset()
            }
            $('#notification').slideDown()
        })
        return false
    }
    fetch()
</script>

</html>